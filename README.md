![python workflow](https://github.com/ofmla/githubactions_intro/actions/workflows/python_env.yml/badge.svg)
![fortran workflow](https://github.com/ofmla/githubactions_intro/actions/workflows/main.yml/badge.svg)

# A (very) quick introduction to GitHub Actions

**Author:** Oscar Mojica, Supercomputing Center for Industrial Innovation, Senai Cimatec

In this tutorial we will introduce Github Actions as a tool for lightweight automation of scientific data workflows. While GitHub Actions have become integral to the software development lifecycle, many scientific programmers, 
especially those not extensively engaged in software deployment, might not be well-acquainted with their features or understand their potential within data pipelines. Using straightforward examples, we aim to showcase how GitHub 
Actions can be applied to automate various data processing tasks. Our objective is to empower participants to envision and implement their own strategies for integrating GitHub Actions into their work processes.

**Prerequisites:** GitHub account, basic familiarity with git, Github, and version control, programming in Interpreted/Compiled Programming Languages.

**Audience:** scientific programmers interested in automating components of their workflows through existing tools for software continuous integration/deployment.

## GitHub Actions Introduction
* [Intro slides](https://github.com/ofmla/githubactions_intro/blob/main/github_actions.pdf)
* [Github actions documentation](https://docs.github.com/en/actions/learn-github-actions/introduction-to-github-actions)

## Setup 
* Fork this repo
* Enable Github Actions:
  * Settings ->   Actions -> Allow actions and reusable workflows
  * [Managing Permissions Documentation](https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#managing-github-actions-permissions-for-your-repository) 

# GitHub Actions Python Environment Workflow
First, we will run a basic workflow which creates a python environment with a few scientific packages and prints out their version
* [.github/workflows/python_env.yml](https://github.com/ofmla/githubactions_intro/blob/main/.github/workflows/python_env.yml)
* go to **Actions** tab, click on **Python Environment**, and click **Run workflow**: this will manually trigger the workflow ([`dispatch_workflow`](https://docs.github.com/en/actions/managing-workflow-runs/manually-running-a-workflow))
* click on the newly created run to see the execution progress

# Numerical inverse Laplace transform Visualization Workflow
Next, we will demonstrate how GitHub Actions can be used to display an image in a GitHub README generated by the workflow (only if the image changed). In this specific example, a Fortran implementation of the Gaver Stehfest algorithm 
[Stehfest, Harald. "Algorithm 368: Numerical inversion of Laplace transforms [D5]." Communications of the ACM 13.1 (1970): 47-49.](https://dl.acm.org/doi/pdf/10.1145/361953.361969) is used to determine the inverse Laplace transforms of the function $1/(s+1)$, whose result is $e^{(-t)}$.
The last step of the workflow involves plotting the inverse Laplace transform computed numerically and comparing it with the exact result.

* [`.github/workflows/main.yml`](https://github.com/ofmla/githubactions_intro/blob/main/.github/workflows/main.yml)
* Here's an overview of the workflow:

    * Triggering the Workflow:
        The workflow is triggered by the workflow_dispatch event, allowing manual execution.

    * Job Configuration:
        The workflow defines a job named test that runs on different operating systems (ubuntu-latest and windows-latest).
        It uses a matrix strategy to vary the operating system and compiler toolchain (GCC, Intel) for testing.

    * Permissions:
        Permissions are set to allow the default GITHUB_TOKEN to write to the repository's contents.

    * Steps:
      * a. Checkout Code:
        The code is checked out using the actions/checkout action with submodule support.

      * b. Get Compiler:
        The Fortran compiler is set up based on the specified compiler and version in the matrix.

      * c. Setup Fortran Package Manager (FPM):
        FPM is configured using the fortran-lang/setup-fpm action.

      * d. Run NILP App Test:
        The Fortran compiler version is displayed, and FPM is used to run the NILP app in release mode.

      * e. Get PNG File:
        This step installs gnuplot on Ubuntu and generates a PNG file using the gnuplot script (nilp.p).

      * f. Commit:
        A commit is made to the GitHub repository, adding any changed or new PNG files.

      * g. Upload PNG File:
        PNG files from the png/ directory are uploaded as artifacts named "Graphic."

      * Conditions:
        The last three steps (get png file, commit, upload png file) are conditional on Ubuntu and GCC in the matrix. They execute only if the operating system is Ubuntu and the compiler is GCC.

After the workflow is executed a `nilp.png` file is updated in the repo and is visualized below. **Please note that the PNG file is updated only when changes are made to the source code, resulting in modifications to the text file used by Gnuplot**

![alt text](https://raw.githubusercontent.com/ofmla/githubactions_intro/main/png/nilp.png)


## License

These materials are for a course intended to provide a (very) quick introduction to GitHub Actions. The course is aimed at a scientific audience. Comments, corrections, and additions are welcome.

All source code is made available under the MIT license.

The full text of these licenses is provided in the [LICENSE](https://github.com/ofmla/githubactions_intro/blob/main/LICENSE) file.
